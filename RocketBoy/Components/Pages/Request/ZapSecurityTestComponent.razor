@using RocketBoy.Components.Pages.Models

@if (!string.IsNullOrEmpty(ZapApiKey) && !string.IsNullOrEmpty(ZapBaseUrl))
{
    <button class="btn btn-warning" @onclick="OnStartSecurityTest">Start Security Test</button>
}
@if (SecurityTestInProgress)
{
    <div class="alert alert-info mt-4">
        <h4>Security Test in Progress</h4>
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <pre>@SecurityTestProgressOutput</pre>
    </div>
}
@if (!string.IsNullOrEmpty(SecurityTestOutput))
{
    <div class="alert alert-success mt-4">
        <h4>Security Test Results</h4>
        <pre>@SecurityTestOutput</pre>
        <button class="btn btn-success" @onclick="OnDownloadSecurityTestResults">Download Results</button>
    </div>
}

@code {
    [Parameter] public RequestObject SelectedTab { get; set; }
    [Parameter] public string ZapApiKey { get; set; }
    [Parameter] public string ZapBaseUrl { get; set; }
    [Parameter] public bool SecurityTestInProgress { get; set; }
    [Parameter] public string SecurityTestProgressOutput { get; set; }
    [Parameter] public string SecurityTestOutput { get; set; }
    [Parameter] public EventCallback OnStartSecurityTest { get; set; }
    [Parameter] public EventCallback OnDownloadSecurityTestResults { get; set; }
}